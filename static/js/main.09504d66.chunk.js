(this["webpackJsonpsigmausd-history"]=this["webpackJsonpsigmausd-history"]||[]).push([[0],{193:function(e,t,n){},194:function(e,t,n){},370:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(39),c=n.n(i),s=(n(193),n(102)),o=n(100),u=n(17),l=n(26),b=(n(194),n(195),n(25)),d=n(132),m=n.n(d),f=n(182),j=n(133),h=n.n(j);function v(){var e=b.DateTime.now().toUTC();return{start:O(e.minus({hours:12})),end:O(e)}}function O(e){return b.DateTime.utc(e.year,e.month,e.day)}function x(){return O(b.DateTime.now().toUTC())}function p(e){var t=e.toUTC();return"".concat(t.year,"-").concat(h()(t.month.toString(),2,"0"),"-").concat(h()(t.day.toString(),2,"0"))}var g=n(9),y=n.n(g),S=n(22),T=n(186),k=n(374),C=n(303),D=n(305).default,w=new C.Connection(new Worker(D));function R(e){return N.apply(this,arguments)}function N(){return(N=Object(S.a)(y.a.mark((function e(t){var n,r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p(t),r="".concat("/sigmausd-history","/data/daily/").concat(n,".json"),e.next=4,fetch(r);case 4:return a=e.sent,e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.initDb({name:"sigmausd",tables:[{name:"Items",columns:{id:{primaryKey:!0,dataType:"number"},time:{notNull:!0,dataType:"string"},reserveRatio:{notNull:!0,dataType:"string"},stableCoinPrice:{notNull:!0,dataType:"string"},stableCoinRatio:{notNull:!0,dataType:"string"},reserveCoinPrice:{notNull:!0,dataType:"string"},reserveCoinRatio:{notNull:!0,dataType:"string"}}}]});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(S.a)(y.a.mark((function e(t){var n,r,a,i,c,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.toUTC(),r=x(),a=r.equals(n)){e.next=10;break}return i=n.plus({days:1}).minus({minutes:5}),e.next=7,w.select({from:"Items",where:{id:{"-":{low:n.toMillis(),high:i.toMillis()}}}});case 7:if(!((c=e.sent).length>0)){e.next=10;break}return e.abrupt("return",c);case 10:return e.next=12,R(n);case 12:if(s=e.sent,a){e.next=16;break}return e.next=16,w.insert({into:"Items",upsert:!0,values:s.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{id:b.DateTime.fromISO(e.time).toMillis()})}))});case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return new k.a((function(t){var n=new T.a({concurrency:2});n.on("completed",(function(e){t.next(e)})),n.on("error",(function(e){t.error(e)})),n.addAll(e.map((function(e){return function(){return function(e){return I.apply(this,arguments)}(e).then((function(t){return[e,t]}))}}))).then((function(){return t.complete()}))}))}!function(){M.apply(this,arguments)}();var J=n(184),A=n.n(J),P=n(185),E=n.n(P),H=n(32),L=n(20),U=n(4),B=function(){return Object(U.jsx)("g",{})},_=b.DateTime.utc(2021,5,9,13,38),q=["reserveRatio","stable","reserve"],G={reserveRatio:"Reserve Ratio (%)",stable:"SigmaUSD Ratio ($)",reserve:"SigmaRSV Ratio"},W={reserveRatio:function(e){return"".concat(e," %")},stable:function(e){return"$".concat(e)},reserve:function(e){return e}},$=function(){var e,t,n=Object(r.useState)({}),a=Object(l.a)(n,2),i=a[0],c=a[1],d=Object(r.useState)(v()),j=Object(l.a)(d,2),h=j[0],x=j[1],g=Object(r.useState)(),y=Object(l.a)(g,2),S=y[0],T=y[1],k=Object(r.useState)(void 0),C=Object(l.a)(k,2),D=C[0],w=C[1],R=Object(r.useState)(),N=Object(l.a)(R,2),M=(N[0],N[1]);Object(r.useEffect)((function(){w(void 0)}),[h]);var I=Object(r.useState)(0),J=Object(l.a)(I,2),P=J[0],$=J[1],z=Object(r.useCallback)((function(e,t){c((function(n){return Object(u.a)(Object(u.a)({},n),{},Object(o.a)({},e,t))}))}),[]),K=Object(r.useMemo)((function(){return O(h.end).diff(O(h.start),"days").days+1}),[h]);Object(r.useEffect)((function(){var e=A()(K);$(e.length),F(e.map((function(e){return h.start.plus({days:e})}))).subscribe((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];z(p(n),r),$((function(e){return e-1}))}))}),[z,h,K]);var V=Object(r.useCallback)((function(e){if(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];c({}),x((function(e){var t=b.DateTime.fromJSDate(n),a=b.DateTime.fromJSDate(r);return t.equals(e.start)&&a.equals(e.end)?e:{start:t,end:a}}))}else c({}),x(v())}),[]),Y=Object(r.useMemo)((function(){var e,t,n=m()(Object.keys(i)).reduce((function(e,t){var n;return[].concat(Object(s.a)(e),Object(s.a)(null!==(n=i[t])&&void 0!==n?n:[]))}),[]),r=Math.max(Math.ceil(n.length/5e3),1),a=n.reduce((function(e,t,n){if(n%r===0){var a=b.DateTime.fromISO(t.time);return[].concat(Object(s.a)(e),[[a.toJSDate(),parseInt(t.reserveRatio,10),Math.round(100*parseFloat(t.stableCoinRatio))/100,parseInt(t.reserveCoinRatio,10),a.toMillis()]])}return e}),[]);if(null===a||void 0===a?void 0:a.length){var c=m()(a,(function(e){return e[4]}));return{start:null===(e=c[0])||void 0===e?void 0:e[0],end:null===(t=c[c.length-1])||void 0===t?void 0:t[0],timeSeries:new L.TimeSeries({name:"Data",columns:["time"].concat(q),points:c})}}}),[i]),Z=Object(r.useMemo)((function(){return{value:[h.start.toJSDate(),h.end.toJSDate()],maxDate:b.DateTime.now().toJSDate(),minDate:_.toJSDate()}}),[h]);Object(r.useEffect)((function(){w(Y?new L.TimeRange(Y.start,Y.end):void 0)}),[Y]);var Q=Object(r.useState)(),X=Object(l.a)(Q,2),ee=X[0],te=X[1],ne=Object(r.useRef)(null),re=Object(r.useState)("reserveRatio"),ae=Object(l.a)(re,2),ie=ae[0],ce=ae[1],se=Object(r.useMemo)((function(){var e,t=null===(e=document.querySelector("meta[name=tip]"))||void 0===e?void 0:e.content;return(null===t||void 0===t?void 0:t.includes("REACT_APP_TIP"))?void 0:t}),[]);return Object(U.jsxs)("div",{className:"App container min-vh-100",children:[Object(U.jsx)(f.a,{color:"#f11946",progress:(K-P)/K*100,onLoaderFinished:function(){return $(0)}}),Object(U.jsx)("a",{className:"github-fork-ribbon",href:"https://github.com/bdkent/sigmausd-history","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub",target:"_blank",rel:"noreferrer",children:"Fork me on GitHub"}),Object(U.jsxs)("div",{className:"d-flex flex-column min-vh-100",children:[Object(U.jsxs)("div",{children:[Object(U.jsx)("h1",{children:"SigmaUSD History"}),Object(U.jsxs)("div",{className:"d-flex flex-wrap",children:[Object(U.jsx)("div",{className:"flex-fill",children:Object(U.jsx)(E.a,Object(u.a)(Object(u.a)({},Z),{},{onChange:V,format:"MMM d, y"}))}),Object(U.jsx)("div",{className:"flex-fill",children:Object(U.jsx)("select",{value:ie,className:"form-select",onChange:function(e){ce(e.target.value)},children:q.map((function(e){return Object(U.jsx)("option",{value:e,children:G[e]},e)}))})})]}),Object(U.jsx)("hr",{})]}),Object(U.jsx)("div",{className:"flex-grow-1 ",ref:ne,children:Y&&Object(U.jsx)(H.Resizable,{children:Object(U.jsx)(H.ChartContainer,{timeRange:D,maxTime:Z.maxDate,minTime:Z.minDate,timeAxisAngledLabels:!0,timeAxisHeight:65,onMouseMove:function(e,t){return M(e&&t?[e,t]:void 0)},enablePanZoom:!0,onTimeRangeChanged:w,onTrackerChanged:function(e){te(e),e||M(void 0)},minDuration:36e5,children:Object(U.jsxs)(H.ChartRow,{height:.75*(null!==(e=null===(t=ne.current)||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:400),children:[Object(U.jsx)(H.YAxis,{id:"y",label:G[ie],min:Y.timeSeries.min(ie,(function(e){return e})),max:Y.timeSeries.max(ie),width:"60",type:"linear"}),Object(U.jsxs)(H.Charts,{children:[Object(U.jsx)(H.Baseline,{axis:"y",value:400,label:"400%",position:"left"}),Object(U.jsx)(H.Baseline,{axis:"y",value:800,label:"800%",position:"left"}),Object(U.jsx)(H.LineChart,{axis:"y",breakLine:!1,series:Y.timeSeries,columns:["time",ie],selection:S,onSelectionChange:function(e){return T(e)},interpolation:"curveBasis"}),ee?Object(U.jsx)(H.EventMarker,{type:"flag",axis:"y",event:Y.timeSeries.atTime(ee),info:[{label:G[ie],value:W[ie]("".concat(Y.timeSeries.atTime(ee).get(ie)))}],infoWidth:180,column:ie,markerRadius:3,markerStyle:{fill:"black"}}):Object(U.jsx)(B,{}),Object(U.jsx)("g",{})]})]})})})}),Object(U.jsxs)("div",{children:[Object(U.jsx)("hr",{}),Object(U.jsx)("footer",{className:"navbar navbar-expand-lg navbar-light bg-light",children:Object(U.jsxs)("div",{className:"container-fluid",children:[Object(U.jsx)("ul",{className:"navbar-nav",children:Object(U.jsx)("li",{className:"nav-item",children:Object(U.jsx)("a",{href:"http://sigmausd.io",className:"nav-link",target:"_blank",rel:"noreferrer",children:"sigmausd.io"})})}),se&&Object(U.jsx)("a",{href:"https://explorer.ergoplatform.com/en/addresses/".concat(se),target:"_blank",rel:"noreferrer",children:"\u2665 donations"})]})})]})]})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,375)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};c.a.render(Object(U.jsx)(a.a.StrictMode,{children:Object(U.jsx)($,{})}),document.getElementById("root")),z()}},[[370,1,2]]]);
//# sourceMappingURL=main.09504d66.chunk.js.map